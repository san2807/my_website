<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <title>sqlserver</title></head>

  <body style="background-color: rgb(255, 255, 204); color: rgb(0, 0, 0);" alink="#ee0000" link="#0000ee" vlink="#551a8b">
    <h1><b>SQL SERVER</b></h1>
    <a href="joins.html">Joins</a><br>
    <br>
    Subqueries<br>
    <br>
    <a href="#exists">EXISTS <i>Predicate</i></a><br>
    <br>
    <a href="#set"><b>Set Operators</b></a><br>
    UNION Operator<br>
    UNION ALL Operator<br>
    INTERSECT Operator<br>
    EXCEPT Operator<br>
    Precedence<br>
    <br>
    Procedures<br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <b>Subqueries<br>
    </b>* subquery can b self-contained or correlated.<br>
    <br>
    * self-contained has no dependency on tables of outer query<br>
    * <br>
    <b><br>
    </b><b></b><br>
    <b><a name="exists"></a>EXISTS</b><br>
    * accepts subquery as input<br>
    * returns TRUE if subquery returns any rows and FALSE otherwise.<br>
    * e.g. customers from spain who placesd orders:<font size="-1"><br>
      &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
      &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; SELECT
      custid, companyname</font><font size="-1"><br>
      &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
      &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; FROM
      Sales.Customers AS C</font><font size="-1"><br>
      &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
      &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; WHERE
      country = N'Spain'</font><font size="-1"><br>
      &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
      &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
      &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
      &nbsp;&nbsp; AND EXISTS</font><font size="-1"> (SELECT * <br>
      &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
      &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
      &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
      &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
      &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FROM Sales.Orders
      AS O</font><font size="-1"><br>
      &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
      &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
      &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
      &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
      &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
      &nbsp;&nbsp;&nbsp;&nbsp; WHERE O.custid = C.custid);</font><br>
    <br>
    <br>
    <b>Returning previous or next values</b><br>
    <blockquote><font size="-1">SELECT&nbsp; orderid</font><br>
      <font size="-1">&nbsp;, orderdate</font><br>
      <font size="-1">&nbsp;, empid</font><br>
      <font size="-1">&nbsp;, custid</font><br>
      <font size="-1">&nbsp;, (</font><br>
      <font size="-1">&nbsp;&nbsp; SELECT MAX(O2.orderid) <br>
        &nbsp;&nbsp;&nbsp; FROM Sales.Orders AS O2 <br>
        &nbsp;&nbsp;&nbsp; WHERE O2.orderid &lt; O1.orderid</font><br>
      <font size="-1">&nbsp; ) AS prevorderid</font><br>
      <font size="-1">&nbsp;FROM Sales.Orders AS O1;</font><br>
    </blockquote>
    <blockquote><font size="-1">SELECT&nbsp; orderid</font><br>
      <font size="-1">&nbsp;, orderdate</font><br>
      <font size="-1">&nbsp;, empid</font><br>
      <font size="-1">&nbsp;, custid</font><br>
      <font size="-1">&nbsp;, (</font><br>
      <font size="-1">&nbsp;&nbsp; SELECT MIN(O2.orderid) <br>
        &nbsp;&nbsp;&nbsp; FROM Sales.Orders AS O2 <br>
        &nbsp;&nbsp;&nbsp; WHERE O2.orderid &gt; O1.orderid</font><br>
      <font size="-1">&nbsp; ) AS nextorderid</font><br>
      <font size="-1">&nbsp;FROM Sales.Orders AS O1;</font><br>
    </blockquote>
    =================================================================<br>
    <a name="set"></a>Set Operators<br>
    * operators that combine rows from two query result sets (or
    multisets)<br>
    <br>
    <br>
    UNION<br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <b>Procedures</b><br>
    * is a stored program that u can pass parameters into. [<a href="https://www.techonthenet.com/sql_server/procedures.php">1</a>]<br>
    * does not return a value like function [<a href="https://www.techonthenet.com/sql_server/procedures.php">1</a>]<br>
    * can return success/failure status to the procedure that called it.
    [<a href="https://www.techonthenet.com/sql_server/procedures.php">1</a>]<br>
    <br>
    <br>
    <a href="https://mva.microsoft.com/">https://mva.microsoft.com/</a><br>
    <a href="https://technet.microsoft.com/en-us/">https://technet.microsoft.com/en-us/</a><br>
    FAQ: Microsoft SQL Server Data Tools [<a href="https://msdn.microsoft.com/en-us/data/hh322942">https://msdn.microsoft.com/en-us/data/hh322942</a>]<br>
    <br>
    <br>
    <br>
  </body></html>